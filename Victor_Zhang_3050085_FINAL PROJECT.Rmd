---
title: "FINAL PROJECT"
author: "Victor Zhang"
date: "2023-03-06"
output: pdf_document
---

```{r setup, include = FALSE}

knitr::opts_chunk$set(echo = F,
                      message = F, 
                      warning = F,
                      fig.width=9, fig.height=3) 

```

```{r}

library(tidyverse)
library(tidyr)
library(GGally)
library(ggplot2)
library(ggfortify)
library(forecast)
library(Mcomp)
library(fabletools)
library(readr)
library(knitr)
library(zoo)
library(dplyr)
library(lubridate)
library(fpp2)
library(tsibble)
library(seasonal)
library(seasonalview)
library(xts)
library(MASS)
library(fpp3)
library(patchwork)

```


# Executive Summary





# Introduction

```{r}

```


The problem I am studying for this project is how the yield spread of the 2-year and 10-year U.S. T-notes is affected by the U.S. economic performance indicators such as the unemployment rate, flexible CPI, and the federal fund effective rate.


Recently, the U.S. Treasury yield spread, the difference between the Fed's short-term borrowing rate and the rate on longer-term U.S. Treasury notes, dropped below zero, which wasn’t a good sign for the U.S. economy. The yield spread shifts based on actions in the bond market, and it can be seen as an important predictor for the future of the U.S. economic. 


Usually, people would earn interest when they buy any treasury note from the U.S. government since the treasury note acts like a loan that the U.S. government takes from them. The longer the loan, the higher the interest rate because the longer loan has a higher risk. For this reason, people would expect it to be cheaper to purchase short-term bonds than long-term bonds since the short-term bonds have lowers risk and the U.S. government would also pay lower interest rate for them.


The difference between the long-term bonds’ yield and the short-term bonds’ yields is called the yield spread. For example, according to “The U.S. Treasury Yield Spread” by Thomas Kenny (2022), one of the most common yield spreads is the one that presents the yield difference between the 2-year T-notes (Treasury Bonds) and 10-year T-notes. This yield spreads is calculated by using the 10-year T-notes' yield minus the 2-year T-notes' yield, and it rises as the difference increases and declines as the difference decreases. When it drops below zero, it means that the yield is inverted, which indicates that short-term bonds are yielding more than long-term bonds. According to the article (Kenny, 2022), The yield spread became inverted at three crucial moments in time: just prior to the recession of the early 1990s, before the bursting of the technology stock bubble in 2000-2001, and before the financial crisis of 2007-2008. In each case, the yield curve provided an advance warning of severe weakness in the stock market. From this perspective, the yield spread can be seen as a crucial predictor for the future U.S. economy, and it might have some lag effects associate with economic indicators such as the unemployment rate, flexible CPI, and the federal fund effective rate that reflect on the current U.S. economic performance.


The unemployment rate is the percentage of unemployed workers in the total labor force, and It is commonly recognized as a performance indicator of the labor market. In the article “How the Unemployment Rate Affects Everybody” by Elvis Picardo (2022), when workers are unemployed, their families lose wages, and the nation as a whole loses their contribution to the economy in terms of the goods or services that could have been produced. Unemployed workers also lose their purchasing power, which can lead to unemployment for other workers, creating a cascading effect that ripples through the economy. From this point of view, unemployment impacts everybody that is connected to the economy.


On the other hand, the Consumer Price Index (CPI) is a measure of the average change over time in the prices paid by urban consumers for a market basket of consumer goods and services. The flexible CPI is calculated from a subset of goods and services included in the CPI that change price relatively frequently. According to the article “Are Some Prices in the CPI More Forward Looking Than Others? We Think So” by Michael F. Bryan and Brent H. Meyer (2010), because these services and goods change their price quickly, it assumes that when their prices are settled, the flexible CPI don’t closely relate to the inflation. Rather, it is more responsive to changes in the current economic environment since it is flexible to change.


Lastly, the federal funds rate is the interest rate that depository banks trade federal funds (balances held at Federal Reserve Banks) with each other overnight. The federal funds effective rate is the weighted average rate for the federal funds rate amongst all depository banks, which is determined by the market and influenced by the Federal Reserve. The Federal Open Market Committee (FOMC) meets eight times a year to determine and set the federal funds target rate via buying or selling government bonds. 


According to the “Monetary Policy” by the Board of Governors of the Federal Reserve System (2023), If the FOMC believes the economy is growing too fast and inflation pressures are inconsistent with the dual mandate of the Federal Reserve, the Committee may set a higher federal funds rate target to temper economic activity. In the opposing scenario, the FOMC may set a lower federal funds rate target to spur greater economic activity. Thus, the federal funds effective rate is closely related to the current performance of the U.S. economy and influences many other interest rates and financial products that involve interest rates.


The four datasets, including the yield spread of the 2-year and 10-year U.S. T-notes, the unemployment rate, flexible CPI, and the federal fund effective rate are all from FRED or Federal Reserve Economic Data. FRED is created and maintained by the Research Department at the Federal Reserve Bank of St. Louis, which makes it a trusted source. Moreover, since I am studying U.S. economic performance, I believe it is better to collect data from the institution that direct response to the U.S. economy, which is the Federal Reserve Bank.



# Data Analysis and Experimental Design


```{r}

Flex_CPI <- read_csv(file = "C:/Users/victo/Desktop/project/COREFLEXCPIM159SFRBATL.csv")
Flex_CPI_ts <- Flex_CPI[,2] %>% ts(start = 2000, frequency = 12)
  
Unemployment_Rate <- read_csv(file = "C:/Users/victo/Desktop/project/UNRATE.csv")
Unemployment_Rate_ts <- Unemployment_Rate[,2] %>% ts(start = 2000, frequency = 12)


Federal_Effective_Rate <- read_csv(file = "C:/Users/victo/Desktop/project/DFF.csv")
Federal_Effective_Rate_ts <- Federal_Effective_Rate[,2] %>% ts(start = 2000, frequency = 12)


T10Y_2Y  <- read_csv(file = "C:/Users/victo/Desktop/project/T10Y2Y.csv")
T10Y_2Y_ts <- T10Y_2Y[,2] %>% ts(start = 2000, frequency = 12)

all_ts <- cbind(T10Y_2Y_ts, Unemployment_Rate_ts, Federal_Effective_Rate_ts, Flex_CPI_ts*0.01)

GGally::ggpairs(as.data.frame(all_ts[,1:4]))

```



```{r}
p1 <- autoplot(T10Y_2Y_ts)

T10Y_2Y_ts_diff <- diff(T10Y_2Y_ts)

p2 <- autoplot(T10Y_2Y_ts_diff)

p1 + p2

par(mfrow=c(1,2))
acf(T10Y_2Y_ts_diff, na.action = na.pass)
pacf(T10Y_2Y_ts_diff, na.action = na.pass)

Box.test(T10Y_2Y_ts_diff, lag = 1, type = c("Box-Pierce"), fitdf = 0)
Box.test(T10Y_2Y_ts_diff, lag = 1, type = c("Ljung-Box"), fitdf = 0)


# can't do boxcox since involves negative values
# see evidence to reject the Null and so there is insufficient evidence to suggest we have not got useful autocorrelation structure - so we can model this with time series models (need test statistic, decision rules, euqations, and babababa)

```




```{r}

T10Y_2Y_ts_decomp <- decompose(T10Y_2Y_ts)

autoplot(T10Y_2Y_ts_decomp)

par(mfrow=c(1,2))
acf(T10Y_2Y_ts_decomp$random, na.action = na.pass)
pacf(T10Y_2Y_ts_decomp$random, na.action = na.pass)

Box.test(T10Y_2Y_ts_decomp$random, lag = 1, type = c("Box-Pierce"), fitdf = 0)
Box.test(T10Y_2Y_ts_decomp$random, lag = 1, type = c("Ljung-Box"), fitdf = 0)


```


```{r}

p3 <- autoplot(Flex_CPI_ts)

Flex_CPI_ts_diff <- diff(Flex_CPI_ts)

p4 <- autoplot(Flex_CPI_ts_diff)

p3 + p4

par(mfrow=c(1,2))
acf(Flex_CPI_ts_diff, na.action = na.pass)
pacf(Flex_CPI_ts_diff, na.action = na.pass)

Box.test(Flex_CPI_ts_diff, lag = 1, type = c("Box-Pierce"), fitdf = 0)
Box.test(Flex_CPI_ts_diff, lag = 1, type = c("Ljung-Box"), fitdf = 0)



# can't do boxcox since involves negative values
# see evidence to reject the Null and so there is insufficient evidence to suggest we have not got useful autocorrelation structure - so we can model this with time series models (need test statistic, decision rules, euqations, and babababa)

```

```{r}


Flex_CPI_ts_decomp <- decompose(Flex_CPI_ts)

autoplot(Flex_CPI_ts_decomp)


par(mfrow=c(1,2))
acf(Flex_CPI_ts_decomp$random, na.action = na.pass)
pacf(Flex_CPI_ts_decomp$random, na.action = na.pass)

Box.test(Flex_CPI_ts_decomp$random, lag = 1, type = c("Box-Pierce"), fitdf = 0)
Box.test(Flex_CPI_ts_decomp$random, lag = 1, type = c("Ljung-Box"), fitdf = 0)



```



```{r}

p5 <- autoplot(Unemployment_Rate_ts)

Unemployment_Rate_ts_diff <- diff(Unemployment_Rate_ts)

p6 <- autoplot(Unemployment_Rate_ts_diff)

p5 + p6

Box.test(Unemployment_Rate_ts_diff, lag = 1, type = c("Box-Pierce"), fitdf = 0)
Box.test(Unemployment_Rate_ts_diff, lag = 1, type = c("Ljung-Box"), fitdf = 0)

boxcox(lm(Unemployment_Rate_ts ~ 1)) # ngeative 1 power transformation


Unemployment_Rate_ts_new <- Unemployment_Rate_ts**(-1)

p7 <- autoplot(Unemployment_Rate_ts_new)

Unemployment_Rate_ts_diff2 <- diff(Unemployment_Rate_ts_new)

p8 <- autoplot(Unemployment_Rate_ts_diff2)

p7 + p8

par(mfrow=c(1,2))
acf(Unemployment_Rate_ts_diff2, na.action = na.pass)
pacf(Unemployment_Rate_ts_diff2, na.action = na.pass)


Box.test(Unemployment_Rate_ts_diff2, lag = 1, type = c("Box-Pierce"), fitdf = 0)
Box.test(Unemployment_Rate_ts_diff2, lag = 1, type = c("Ljung-Box"), fitdf = 0)


```

```{r}

Unemployment_Rate_ts_decomp <- decompose(Unemployment_Rate_ts)

autoplot(Unemployment_Rate_ts_decomp)

par(mfrow=c(1,2))
acf(Unemployment_Rate_ts_decomp$random, na.action = na.pass)
pacf(Unemployment_Rate_ts_decomp$random, na.action = na.pass)


Box.test(Unemployment_Rate_ts_decomp$random, lag = 1, type = c("Box-Pierce"), fitdf = 0)
Box.test(Unemployment_Rate_ts_decomp$random, lag = 1, type = c("Ljung-Box"), fitdf = 0)


```



```{r}

p9 <- autoplot(Federal_Effective_Rate_ts)

Federal_Effective_Rate_ts_diff <- diff(Federal_Effective_Rate_ts)

p10 <- autoplot(Federal_Effective_Rate_ts_diff)

p9 + p10

boxcox(lm(Federal_Effective_Rate_ts ~ 1)) # 0, indicates log (natural log) transformation


Federal_Effective_Rate_ts_new <- log(Federal_Effective_Rate_ts)

p11 <- autoplot(Federal_Effective_Rate_ts_new)


Federal_Effective_Rate_ts_diff2 <- diff(Federal_Effective_Rate_ts_new)

p12 <- autoplot(Federal_Effective_Rate_ts_diff2)

p11 + p12


par(mfrow=c(1,2))
acf(Federal_Effective_Rate_ts_diff2, na.action = na.pass)
pacf(Federal_Effective_Rate_ts_diff2, na.action = na.pass)

Box.test(Federal_Effective_Rate_ts_diff2, lag = 1, type = c("Box-Pierce"), fitdf = 0)
Box.test(Federal_Effective_Rate_ts_diff2, lag = 1, type = c("Ljung-Box"), fitdf = 0)


```

```{r}



Federal_Effective_Rate_ts_decomp <- decompose(Federal_Effective_Rate_ts)

autoplot(Federal_Effective_Rate_ts_decomp)

par(mfrow=c(1,2))
acf(Federal_Effective_Rate_ts_decomp$random, na.action = na.pass)
pacf(Federal_Effective_Rate_ts_decomp$random, na.action = na.pass)


Box.test(Federal_Effective_Rate_ts_decomp$random, lag = 1, type = c("Box-Pierce"), fitdf = 0)
Box.test(Federal_Effective_Rate_ts_decomp$random, lag = 1, type = c("Ljung-Box"), fitdf = 0)


```









# Time Series Modelling and Forecasting


```{r}



T10Y_2Y_ts_fit1 <- auto.arima(T10Y_2Y_ts_diff, max.order = 12)

summary(T10Y_2Y_ts_fit1)

checkresiduals(T10Y_2Y_ts_fit1)



T10Y_2Y_ts_fit2 <- auto.arima(T10Y_2Y_ts_decomp$random, max.order = 12)

summary(T10Y_2Y_ts_fit2)

checkresiduals(T10Y_2Y_ts_fit2)




```






```{r}


Flex_CPI_ts_fit1 <- auto.arima(Flex_CPI_ts_diff, max.order = 12)

summary(Flex_CPI_ts_fit1)

checkresiduals(Flex_CPI_ts_fit1)


Flex_CPI_ts_fit2 <- auto.arima(Flex_CPI_ts_decomp$random, max.order = 12)

summary(Flex_CPI_ts_fit2)

checkresiduals(Flex_CPI_ts_fit2)


```




```{r}

Unemployment_Rate_ts_fit1 <- auto.arima(Unemployment_Rate_ts_diff2, max.order = 12)

summary(Unemployment_Rate_ts_fit1)

checkresiduals(Unemployment_Rate_ts_fit1)


Unemployment_Rate_ts_fit2 <- auto.arima(Unemployment_Rate_ts_decomp$random, max.order = 12)

summary(Unemployment_Rate_ts_fit2)  #compare AIC, residuals, and RMSE(lowever, better)

checkresiduals(Unemployment_Rate_ts_fit2)

```






```{r}



Federal_Effective_Rate_ts_fit1 <- auto.arima(Federal_Effective_Rate_ts_diff2, max.order = 12)

summary(Federal_Effective_Rate_ts_fit1)

checkresiduals(Federal_Effective_Rate_ts_fit1)



Federal_Effective_Rate_ts_fit2 <- auto.arima(diff(Federal_Effective_Rate_ts_decomp$random), max.order = 12)

summary(Federal_Effective_Rate_ts_fit2)

checkresiduals(Federal_Effective_Rate_ts_fit2)




```













# Discussion and Conclusions

```{r}

```







































\newpage

# Bibliography and Appendix


```{r}

```



Board of Governors of the Federal Reserve System (US)., 2023. *Federal Funds Effective Rate [DFF]*. retrieved from FRED, Federal Reserve Bank of St. Louis., [Online], Accessed:  6 March 2023 \
Available:  https://fred.stlouisfed.org/series/DFF, March 6, 2023.



Board of Governors of the Federal Reserve System., 2023. *Monetary Policy*. [Online], Accessed:  1 March 2023 \
Available: https://www.federalreserve.gov/monetarypolicy.htm



Bryan, Michael F., and Brent Meyer., 2010. “Are Some Prices in the CPI More Forward Looking Than Others? We Think So”. Federal Reserve Bank of Cleveland, Economic Commentary., [Online], \
Accessed:  1 March 2023 \
Available: https://doi.org/10.26509/frbc-ec-201002



Chatfield C., 2003. *The analysis of time series: an introduction*. CHAPMAN & HALL/CRC.



Federal Reserve Bank of New York., 2007. *Federal funds*. Fedpoints.



Federal Reserve Bank of St. Louis,. 2023. *10-Year Treasury Constant Maturity Minus 2-Year Treasury Constant Maturity [T10Y2Y]*. retrieved from FRED, Federal Reserve Bank of St. Louis., [Online], \
Accessed:  6 March 2023 \
Available: https://fred.stlouisfed.org/series/T10Y2Y



Federal Reserve Bank of Atlanta., 2023. *Flexible Price Consumer Price Index less Food and Energy [COREFLEXCPIM159SFRBATL]*. retrieved from FRED, Federal Reserve Bank of St. Louis., \
[Online], Accessed:  6 March 2023 \
Available: https://fred.stlouisfed.org/series/COREFLEXCPIM159SFRBATL



Kenny, Thomas., 2022. “The U.S. Treasury Yield Spread”. The Balance., [Online], \
Accessed:  1 March 2023 \
Available: https://www.thebalancemoney.com/2-to-10-year-us-treasury-yield-spread-1976-present-417139



Peters, G.W., 2023. *Lecture Notes*. UCSB.



Picardo, Elvis,. 2022. “How the Unemployment Rate Affects Everybody”. Investopedia., [Online], \
Accessed:  1 March 2023  \
Available: https://www.investopedia.com/articles/economics/10/unemployment-rate-get-real.asp



Rob J Hyndman and George Athanasopoulos., 2018. *Forecasting: Principles and Practice*. OTexts.



U.S. Bureau of Labor Statistics., 2023. *Unemployment Rate [UNRATE]*. retrieved from FRED, Federal Reserve Bank of St. Louis., [Online], Accessed:  6 March 2023 \
Available: https://fred.stlouisfed.org/series/UNRATE











